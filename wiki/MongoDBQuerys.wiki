#summary Ragpicker MongoDB querys.
#labels Packer,PEID,MongoDB,SigCheck

= Ragpicker MongoDB querys =

== Find a file by sha256 ==

<code>db.ragpicker.find({'Info.file.sha256':"c029a3dc28c32075ed24ef7f441a4b33758aea4e9a2fd87afb4aee403ad404d6"})</code>

== Packer Statistics ==

<code>db.ragpicker.aggregate(
    { $group : {
        _id : "$PEID",
        count : { $sum: 1 }
    }},
    {$sort:{"count": -1}}
);</code>

== Digital signatures ==

<code>db.ragpicker.aggregate(
    { $group : {
        _id : { PublisherO: "$VerifySigs.PublisherO",  Issuer: "$VerifySigs.Issuer" }, 
        count : { $sum: 1 }
    }},
    {$sort:{"count": -1}}
);</code>

== EXE, DLL and DRIVER ==

<code>db.ragpicker.aggregate(
     { $group : {
         _id : { EXE: { $ifNull: [ "$Info.file.EXE", false ] },
                 DLL: { $ifNull: [ "$Info.file.DLL", false ] },
                 DRIVER: { $ifNull: [ "$Info.file.DRIVER", false ] } }, 
                 count : { $sum: 1 }, 
     }},
     {$sort:{"count": -1}}
 );</code>